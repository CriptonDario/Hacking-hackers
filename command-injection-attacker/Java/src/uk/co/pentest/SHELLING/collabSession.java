/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package uk.co.pentest.SHELLING;

import burp.IHttpRequestResponse;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Date;

/**
 *
 * @author julian
 */
public class collabSession {
    protected int ID;
    protected String config; // could store it in a similar manner CVSS is interpreted
    protected String action;
    protected static int count=0;
    protected String created;
    protected String insertionPointName;
    protected String collabLoc;
    protected IHttpRequestResponse baseReqRes;
    protected ArrayList<String> shellings_raw;
    // would be really nice to save the configuration for the given section
    // this would allow to trace the asonchronous cases from Intruder better   
    // but about saving the entire payload set instead?
    
    public collabSession(String loc, String act, IHttpRequestResponse value, String paramName)
    {
        this.collabLoc=loc.substring(0,30); // we only need first 30 chars
        this.ID=this.count++;
        this.action=act;
        this.created = new SimpleDateFormat("yyyy.MM.dd HH:mm:ss").format(new Date());        
        this.insertionPointName=paramName;
        this.setReqResp(value);
    }
    public void setReqResp(IHttpRequestResponse value)
    {
        this.baseReqRes=value;
    }
    public String getLoc()
    {
        return this.collabLoc;
    }
    public String getCreated()
    {
        return this.created;
    }
    // we want to store this in the session tracker for the sake of accuracy
    public void setShellingsRaw(ArrayList raw)
    {
        this.shellings_raw=raw;
    }
    public void setCount(int c)
    {
        this.count=c;
    }
    public ArrayList<String> getShellingsRaw()
    {
        return this.shellings_raw;
    }
    public void setInsertionPointName(String n)
    {
        this.insertionPointName=n;
    }
    public String getInsertionPointName()
    {
        return this.insertionPointName;
    }
 }
